Battery Management System Firmware
----------------------------------

(c) K. Sarkies 13/01/2014

This project provides software for monitoring, control and charging of batteries
for a solar powered installation.

The motivation to build this arose from the poor performance and lack of
adequate control, lack of configuration for different battery types, and poor
user interface of commercially available BMS.

The software is written for an STM32F103 ARM Cortex M3 microcontroller and uses
specific hardware that will be published later.

The system allows for up to three batteries to be managed separately. This
ensures that failed batteries may be isolated without adversely affecting the
other batteries as could happen if batteries were connected in parallel. Also
note that if batteries were connected in parallel, the same type and age of
battery must be used, which would necessitate changing all batteries if one were
to fail.

The system also allows for up to two loads so that critical low current loads
may be kept running after high current loads are disconnected in the event
that all batteries fall to critically low charge levels.

The system uses several methods of tracking the State of Charge of each battery,
This is a notoriously difficult parameter to estimate. In a system with three
batteries one may be isolated long enough to allow the terminal voltage to
settle to a level that will allow SoC to be computed accurately.

In the long term it is intended to allow a variety of configurations for
charging and monitoring of batteries.

A wide range of state information is stored on a removable memory, and also
transmitted over a serial link to allow a GUI to display the state accurately
and in detail.

The software uses libopencm3 for hardware drivers, FreeRTOS and ChaN FAT for
managing the local storage filesystem. It is intended later to use CANopen
to manage communications with an external PC.


